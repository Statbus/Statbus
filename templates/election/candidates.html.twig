{% extends 'base.html.twig' %}

{% block body %}
	<h1 class="border-bottom border-4">Candidates for
		{{ election.getName }}
		(#{{ election.getId }})
	</h1>

	{% if not election.hasFilter %}
		<div class="alert alert-warning">
			<strong>Heads Up!</strong>
			This election
			<em>does not</em>
			have a vote filter assigned! All votes will be processed by the default filter!</div>
	{% endif %}

	<table class="table align-middle">
		<thead>
			<tr>
				<th>Name</th>
				<th>Link / Description</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{% for c in election.getCandidates %}
				<tr>
					<td>{{ c.getName }}</td>
					<td>
						<a href="{{ c.getLink }}" target="_blank">{{ c.getLink }}</a>
					</td>
					<td>
						{% if not election.started and not election.over %}
							<a href="#" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal" data-id="{{c.getId}}">
								<i class="fas fa-circle-xmark"></i>
								Delete</a>
						{% endif %}
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="3">{{ component('NoData', { message: 'No candidates' }) }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<p class="text-muted">
		<i class="fas fa-shuffle"></i>
		The list of candidates will be initially presented to the voter in a random order</p>
	<div class="card">
		<h3 class="card-header">Add a New Candidate</h3>
		<div class="card-body">
			{% if not election.started and not election.over %}
				{{ form_start(form) }}
				{{ form_row(form.name) }}
				{{ form_row(form.link) }}
				{{ form_row(form.description) }}
				{{ form_row(form.submit) }}
				{{ form_end(form) }}
			{% else %}
				{{ component('NoData', { message: 'This election is underway, or finished' }) }}
			{% endif %}
		</div>
		{% if not election.started %}
			<div class="card-footer">Candidates may be added or removed until
				{{election.start|date}}</div>
		{% endif %}
	</div>

	<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content rounded-3 shadow">
				<div class="modal-body p-4 text-center">
					<h5 class="mb-0">Delete this candidate?</h5>
					<p class="mb-0">This action can not be undone</p>
				</div>
				<form class="modal-footer flex-nowrap p-0" action="/election/{{election.getId}}/candidates/delete/" method="post">
					<button type="submit" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 py-3 m-0 rounded-0 border-end">
						<strong>Yes, delete</strong>
					</button>
					<a href="#" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 py-3 m-0 rounded-0" data-bs-dismiss="modal">No thanks</a>
				</form>
			</div>
		</div>
	</div>
	<script>
		{% include "election/components/deleteCandidate.js.twig" %}</script>
{% endblock %}
